{"version":3,"sources":["pages/KYC.js","components/Page.js"],"names":["RootStyle","styled","Page","height","backgroundColor","padding","theme","spacing","ContentStyle","overflow","position","API_TOKEN","API_SECRET","generateSignature","payloadAsString","apiPrivateKey","signature","crypto","createHmac","update","Buffer","from","digest","toLowerCase","console","log","testStatus","KYCPage","useState","veriffStatus","useEffect","localStorage","getItem","sessionID","sessionUrl","createVeriffFrame","url","onEvent","msg","MESSAGES","CANCELED","FINISHED","fetch","method","headers","then","response","json","data","catch","error","PreviousSession","dateString","Date","toISOString","info","JSON","stringify","axios","post","status","setItem","verification","id","title","sx","paddingTop","maxWidth","flexDirection","alignItems","display","justifyContent","component","variant","textAlign","textTransform","marginBottom","color","fontFamily","fontWeight","fontSize","lineHeight","style","width","forwardRef","ref","children","other","propTypes","PropTypes","node","isRequired","string"],"mappings":"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","file":"static/js/18.b09ad73e.chunk.js","sourcesContent":["/* eslint-disable prettier/prettier */\r\n// material\r\nimport { useEffect, useState } from 'react';\r\nimport { experimentalStyled as styled } from '@material-ui/core/styles';\r\n// components\r\nimport { Container, Typography} from '@material-ui/core';\r\nimport { createVeriffFrame, MESSAGES } from \"@veriff/incontext-sdk\";\r\nimport axios from \"axios\";\r\nimport crypto from \"crypto\";\r\nimport Page from '../components/Page';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst RootStyle = styled(Page)(({ theme }) => ({\r\n  height: '100%',\r\n  backgroundColor: '#F8F9FA',\r\n  padding: theme.spacing(20, 0, 15)\r\n}));\r\n\r\nconst ContentStyle = styled('div')(() => ({\r\n  overflow: 'hidden',\r\n  position: 'relative'\r\n}));\r\n\r\nconst API_TOKEN = \"9db5ac23-8175-4f0c-8d75-151ebe7f98b5\";\r\nconst API_SECRET = \"0e0f46fe-0f3b-4288-8fe9-9e4b4e4ceb7f\";\r\n\r\nexport function generateSignature(payloadAsString, apiPrivateKey) {\r\n\r\n  const signature = crypto\r\n  .createHmac('sha256', apiPrivateKey)\r\n  .update(Buffer.from(payloadAsString, 'utf8'))\r\n  .digest('hex')\r\n  .toLowerCase();\r\n  console.log(\"X-HMAC-SIGNATURE\", signature)\r\n  return signature;\r\n}\r\nexport function testStatus(){\r\n  // const sessionID = \"62c5a13b-fcbb-426d-a7ff-937de05b33c3\";\r\n  // generateSignature(sessionID, API_SECRET);\r\n}\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport default function KYCPage() {\r\n  const [veriffStatus, setVeriffStatus] = useState(false);\r\n\r\n// Get Previous Session\r\n  const PreviousSession = () => {\r\n    const sessionID = localStorage.getItem('sessionID');\r\n    const sessionUrl =localStorage.getItem('sessionUrl');\r\n    // console.log(sessionID, \" - \",sessionUrl)\r\n    createVeriffFrame({\r\n      url: sessionUrl,\r\n      onEvent: (msg) => {\r\n        switch (msg) {\r\n          case MESSAGES.CANCELED:\r\n            //\r\n            break;\r\n          case MESSAGES.FINISHED:\r\n            fetch(`https://stationapi.veriff.com/v1/sessions/${sessionID}/decision`, {\r\n              method: 'GET',\r\n              headers: {\r\n                'Accept' : 'application/json',\r\n                'X-AUTH-CLIENT': API_TOKEN,\r\n                'X-HMAC-SIGNATURE' : generateSignature(sessionID, API_SECRET)\r\n              },\r\n            })\r\n              .then((response) => response.json())\r\n              .then((data) => {\r\n                console.log('Success:', data);\r\n              })\r\n              .catch((error) => {\r\n                console.error('Error:', error);\r\n              });\r\n            break;\r\n          default:\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    // testStatus()\r\n    \r\n    if(!localStorage.getItem('sessionID') && !localStorage.getItem('sessionUrl')){\r\n     \r\n      const nows =new Date();\r\n      const dateString = nows.toISOString();\r\n      const info = JSON.stringify({\r\n        \"verification\": {\r\n          \"callback\": \"https://veriff.com\",\r\n          \"person\": {\r\n            \"firstName\": \"John\",\r\n            \"lastName\": \"Smith\",\r\n            \"idNumber\": \"123456789\"\r\n          },\r\n          \"vendorData\": \" \",\r\n          \"timestamp\": dateString\r\n        }\r\n      });\r\n      const headers = { \r\n        'content-type': 'application/json',\r\n        'X-AUTH-CLIENT': API_TOKEN,\r\n      };\r\n      \r\n      axios.post('https://stationapi.veriff.com/v1/sessions', info, { headers })\r\n        .then(response => {\r\n          console.log('hre', response.data)\r\n          if( response.data.status === \"success\"){\r\n            localStorage.setItem('veriff_data', JSON.stringify(response));\r\n            localStorage.setItem('sessionUrl', response.data.verification.url);\r\n            localStorage.setItem('sessionID', response.data.verification.id);\r\n            const sessionUrl = response.data.verification.url;\r\n            const sessionID = response.data.verification.id;\r\n            createVeriffFrame({\r\n              url: sessionUrl,\r\n              onEvent: (msg) => {\r\n                switch (msg) {\r\n                  case MESSAGES.CANCELED:\r\n                    //\r\n                    break;\r\n                  case MESSAGES.FINISHED:\r\n                    fetch(`https://stationapi.veriff.com/v1/sessions/${sessionID}/decision`, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                      'Accept' : 'application/json',\r\n                      'X-AUTH-CLIENT': API_TOKEN,\r\n                      'X-HMAC-SIGNATURE' : generateSignature(sessionID, API_SECRET)\r\n                    },\r\n                  })\r\n                    .then((response) => response.json())\r\n                    .then((data) => {\r\n                      console.log('Success:', data);\r\n                    })\r\n                    .catch((error) => {\r\n                      console.error('Error:', error);\r\n                    });\r\n                    break;\r\n                  default:\r\n                }\r\n              }\r\n            });\r\n          }\r\n          })\r\n        .catch(error => {\r\n            console.error('There was an error!', error);\r\n        });\r\n\r\n    }\r\n    else{\r\n      console.log(\"Going for previous\");\r\n      // window.location.href=JSON.parse(localStorage.getItem('veriff_data')).verification.url\r\n      PreviousSession();\r\n    }        \r\n  }, []);\r\n  return (\r\n    <RootStyle title=\"App | Backed Capital\" id=\"move_top\">\r\n      <ContentStyle>\r\n        <Container sx={{ position: 'relative', paddingTop: 1, maxWidth: '860px !important', flexDirection: 'column', alignItems: 'center', display: 'flex', justifyContent: 'center' }}>\r\n            <Typography component=\"p\" variant=\"overline\" sx={{ textAlign: 'center', textTransform: 'none', marginBottom: 10, color: '#333333', display: 'block', fontFamily: 'Raleway', fontWeight: 700, fontSize: 48, lineHeight: '64px' }}>\r\n              Verification Page\r\n            </Typography>\r\n           \r\n            <div id='veriff-root' style={{width:'400px'}}> {veriffStatus ? \"Verified\"  : \"Not Verified\"} </div>\r\n\r\n        </Container>\r\n      </ContentStyle>\r\n    </RootStyle>\r\n  );\r\n}\r\n","import PropTypes from 'prop-types';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { forwardRef } from 'react';\r\n// material\r\nimport { Box } from '@material-ui/core';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst Page = forwardRef(({ children, title = '', ...other }, ref) => (\r\n  <Box ref={ref} {...other}>\r\n    <Helmet>\r\n      <title>{title}</title>\r\n    </Helmet>\r\n    {children}\r\n  </Box>\r\n));\r\n\r\nPage.propTypes = {\r\n  children: PropTypes.node.isRequired,\r\n  title: PropTypes.string\r\n};\r\n\r\nexport default Page;\r\n"],"sourceRoot":""}